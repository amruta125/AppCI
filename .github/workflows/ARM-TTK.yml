name: Pre-Deployment Check

env: 
  ENV_FILE: ./POC/config.env 
  TEMPLATE_PATH: ./templates
  TEMPLATE_FILE: mainTemplate.json
  UPDATED_TEMPLATE_PATH: "templates/**"
  UPDATED_SOURCE_PATH: "src/**"
  APPLICATION_PATH: "App1"
    
on: 
  pull_request:
    types: [opened, edited, reopened]
    
jobs:

#  # JOB to run ARM Test Toolkit for arm templates
  test-arm-template:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source code
        uses: actions/checkout@v2.3.3
        
      - name: Run Test ARM Templates
        id: pathtest
        
        uses: aliencube/arm-ttk-actions@v0.3
        with:
          path: ${{env.TEMPLATE_PATH}}
          files: ${{env.TEMPLATE_FILE}}
          
      - name: Test ARM Results
        shell: bash
        continue-on-error: false
        run: |
          echo ${{steps.pathtest.outputs.results}}
